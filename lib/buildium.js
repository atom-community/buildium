"use strict";require("core-js/modules/es.symbol.js"),require("core-js/modules/es.symbol.description.js"),require("core-js/modules/es.symbol.async-iterator.js"),require("core-js/modules/es.symbol.has-instance.js"),require("core-js/modules/es.symbol.is-concat-spreadable.js"),require("core-js/modules/es.symbol.iterator.js"),require("core-js/modules/es.symbol.match.js"),require("core-js/modules/es.symbol.match-all.js"),require("core-js/modules/es.symbol.replace.js"),require("core-js/modules/es.symbol.search.js"),require("core-js/modules/es.symbol.species.js"),require("core-js/modules/es.symbol.split.js"),require("core-js/modules/es.symbol.to-primitive.js"),require("core-js/modules/es.symbol.to-string-tag.js"),require("core-js/modules/es.symbol.unscopables.js"),require("core-js/modules/es.aggregate-error.js"),require("core-js/modules/es.array.concat.js"),require("core-js/modules/es.array.copy-within.js"),require("core-js/modules/es.array.every.js"),require("core-js/modules/es.array.fill.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.array.find.js"),require("core-js/modules/es.array.find-index.js"),require("core-js/modules/es.array.flat.js"),require("core-js/modules/es.array.flat-map.js"),require("core-js/modules/es.array.for-each.js"),require("core-js/modules/es.array.from.js"),require("core-js/modules/es.array.includes.js"),require("core-js/modules/es.array.index-of.js"),require("core-js/modules/es.array.is-array.js"),require("core-js/modules/es.array.iterator.js"),require("core-js/modules/es.array.join.js"),require("core-js/modules/es.array.last-index-of.js"),require("core-js/modules/es.array.map.js"),require("core-js/modules/es.array.of.js"),require("core-js/modules/es.array.reduce.js"),require("core-js/modules/es.array.reduce-right.js"),require("core-js/modules/es.array.reverse.js"),require("core-js/modules/es.array.slice.js"),require("core-js/modules/es.array.some.js"),require("core-js/modules/es.array.sort.js"),require("core-js/modules/es.array.species.js"),require("core-js/modules/es.array.splice.js"),require("core-js/modules/es.array.unscopables.flat.js"),require("core-js/modules/es.array.unscopables.flat-map.js"),require("core-js/modules/es.array-buffer.constructor.js"),require("core-js/modules/es.array-buffer.is-view.js"),require("core-js/modules/es.array-buffer.slice.js"),require("core-js/modules/es.data-view.js"),require("core-js/modules/es.date.get-year.js"),require("core-js/modules/es.date.now.js"),require("core-js/modules/es.date.set-year.js"),require("core-js/modules/es.date.to-gmt-string.js"),require("core-js/modules/es.date.to-iso-string.js"),require("core-js/modules/es.date.to-json.js"),require("core-js/modules/es.date.to-primitive.js"),require("core-js/modules/es.date.to-string.js"),require("core-js/modules/es.escape.js"),require("core-js/modules/es.function.bind.js"),require("core-js/modules/es.function.has-instance.js"),require("core-js/modules/es.function.name.js"),require("core-js/modules/es.global-this.js"),require("core-js/modules/es.json.stringify.js"),require("core-js/modules/es.json.to-string-tag.js"),require("core-js/modules/es.map.js"),require("core-js/modules/es.math.acosh.js"),require("core-js/modules/es.math.asinh.js"),require("core-js/modules/es.math.atanh.js"),require("core-js/modules/es.math.cbrt.js"),require("core-js/modules/es.math.clz32.js"),require("core-js/modules/es.math.cosh.js"),require("core-js/modules/es.math.expm1.js"),require("core-js/modules/es.math.fround.js"),require("core-js/modules/es.math.hypot.js"),require("core-js/modules/es.math.imul.js"),require("core-js/modules/es.math.log10.js"),require("core-js/modules/es.math.log1p.js"),require("core-js/modules/es.math.log2.js"),require("core-js/modules/es.math.sign.js"),require("core-js/modules/es.math.sinh.js"),require("core-js/modules/es.math.tanh.js"),require("core-js/modules/es.math.to-string-tag.js"),require("core-js/modules/es.math.trunc.js"),require("core-js/modules/es.number.constructor.js"),require("core-js/modules/es.number.epsilon.js"),require("core-js/modules/es.number.is-finite.js"),require("core-js/modules/es.number.is-integer.js"),require("core-js/modules/es.number.is-nan.js"),require("core-js/modules/es.number.is-safe-integer.js"),require("core-js/modules/es.number.max-safe-integer.js"),require("core-js/modules/es.number.min-safe-integer.js"),require("core-js/modules/es.number.parse-float.js"),require("core-js/modules/es.number.parse-int.js"),require("core-js/modules/es.number.to-fixed.js"),require("core-js/modules/es.number.to-precision.js"),require("core-js/modules/es.object.assign.js"),require("core-js/modules/es.object.create.js"),require("core-js/modules/es.object.define-getter.js"),require("core-js/modules/es.object.define-properties.js"),require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.object.define-setter.js"),require("core-js/modules/es.object.entries.js"),require("core-js/modules/es.object.freeze.js"),require("core-js/modules/es.object.from-entries.js"),require("core-js/modules/es.object.get-own-property-descriptor.js"),require("core-js/modules/es.object.get-own-property-descriptors.js"),require("core-js/modules/es.object.get-own-property-names.js"),require("core-js/modules/es.object.get-prototype-of.js"),require("core-js/modules/es.object.is.js"),require("core-js/modules/es.object.is-extensible.js"),require("core-js/modules/es.object.is-frozen.js"),require("core-js/modules/es.object.is-sealed.js"),require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.object.lookup-getter.js"),require("core-js/modules/es.object.lookup-setter.js"),require("core-js/modules/es.object.prevent-extensions.js"),require("core-js/modules/es.object.seal.js"),require("core-js/modules/es.object.set-prototype-of.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.object.values.js"),require("core-js/modules/es.parse-float.js"),require("core-js/modules/es.parse-int.js"),require("core-js/modules/es.promise.js"),require("core-js/modules/es.promise.all-settled.js"),require("core-js/modules/es.promise.any.js"),require("core-js/modules/es.promise.finally.js"),require("core-js/modules/es.reflect.apply.js"),require("core-js/modules/es.reflect.construct.js"),require("core-js/modules/es.reflect.define-property.js"),require("core-js/modules/es.reflect.delete-property.js"),require("core-js/modules/es.reflect.get.js"),require("core-js/modules/es.reflect.get-own-property-descriptor.js"),require("core-js/modules/es.reflect.get-prototype-of.js"),require("core-js/modules/es.reflect.has.js"),require("core-js/modules/es.reflect.is-extensible.js"),require("core-js/modules/es.reflect.own-keys.js"),require("core-js/modules/es.reflect.prevent-extensions.js"),require("core-js/modules/es.reflect.set.js"),require("core-js/modules/es.reflect.set-prototype-of.js"),require("core-js/modules/es.reflect.to-string-tag.js"),require("core-js/modules/es.regexp.constructor.js"),require("core-js/modules/es.regexp.dot-all.js"),require("core-js/modules/es.regexp.exec.js"),require("core-js/modules/es.regexp.flags.js"),require("core-js/modules/es.regexp.sticky.js"),require("core-js/modules/es.regexp.test.js"),require("core-js/modules/es.regexp.to-string.js"),require("core-js/modules/es.set.js"),require("core-js/modules/es.string.code-point-at.js"),require("core-js/modules/es.string.ends-with.js"),require("core-js/modules/es.string.from-code-point.js"),require("core-js/modules/es.string.includes.js"),require("core-js/modules/es.string.iterator.js"),require("core-js/modules/es.string.match.js"),require("core-js/modules/es.string.match-all.js"),require("core-js/modules/es.string.pad-end.js"),require("core-js/modules/es.string.pad-start.js"),require("core-js/modules/es.string.raw.js"),require("core-js/modules/es.string.repeat.js"),require("core-js/modules/es.string.replace.js"),require("core-js/modules/es.string.replace-all.js"),require("core-js/modules/es.string.search.js"),require("core-js/modules/es.string.split.js"),require("core-js/modules/es.string.starts-with.js"),require("core-js/modules/es.string.substr.js"),require("core-js/modules/es.string.trim.js"),require("core-js/modules/es.string.trim-end.js"),require("core-js/modules/es.string.trim-start.js"),require("core-js/modules/es.string.anchor.js"),require("core-js/modules/es.string.big.js"),require("core-js/modules/es.string.blink.js"),require("core-js/modules/es.string.bold.js"),require("core-js/modules/es.string.fixed.js"),require("core-js/modules/es.string.fontcolor.js"),require("core-js/modules/es.string.fontsize.js"),require("core-js/modules/es.string.italics.js"),require("core-js/modules/es.string.link.js"),require("core-js/modules/es.string.small.js"),require("core-js/modules/es.string.strike.js"),require("core-js/modules/es.string.sub.js"),require("core-js/modules/es.string.sup.js"),require("core-js/modules/es.typed-array.float32-array.js"),require("core-js/modules/es.typed-array.float64-array.js"),require("core-js/modules/es.typed-array.int8-array.js"),require("core-js/modules/es.typed-array.int16-array.js"),require("core-js/modules/es.typed-array.int32-array.js"),require("core-js/modules/es.typed-array.uint8-array.js"),require("core-js/modules/es.typed-array.uint8-clamped-array.js"),require("core-js/modules/es.typed-array.uint16-array.js"),require("core-js/modules/es.typed-array.uint32-array.js"),require("core-js/modules/es.typed-array.copy-within.js"),require("core-js/modules/es.typed-array.every.js"),require("core-js/modules/es.typed-array.fill.js"),require("core-js/modules/es.typed-array.filter.js"),require("core-js/modules/es.typed-array.find.js"),require("core-js/modules/es.typed-array.find-index.js"),require("core-js/modules/es.typed-array.for-each.js"),require("core-js/modules/es.typed-array.from.js"),require("core-js/modules/es.typed-array.includes.js"),require("core-js/modules/es.typed-array.index-of.js"),require("core-js/modules/es.typed-array.iterator.js"),require("core-js/modules/es.typed-array.join.js"),require("core-js/modules/es.typed-array.last-index-of.js"),require("core-js/modules/es.typed-array.map.js"),require("core-js/modules/es.typed-array.of.js"),require("core-js/modules/es.typed-array.reduce.js"),require("core-js/modules/es.typed-array.reduce-right.js"),require("core-js/modules/es.typed-array.reverse.js"),require("core-js/modules/es.typed-array.set.js"),require("core-js/modules/es.typed-array.slice.js"),require("core-js/modules/es.typed-array.some.js"),require("core-js/modules/es.typed-array.sort.js"),require("core-js/modules/es.typed-array.subarray.js"),require("core-js/modules/es.typed-array.to-locale-string.js"),require("core-js/modules/es.typed-array.to-string.js"),require("core-js/modules/es.unescape.js"),require("core-js/modules/es.weak-map.js"),require("core-js/modules/es.weak-set.js"),require("core-js/modules/esnext.aggregate-error.js"),require("core-js/modules/esnext.array.at.js"),require("core-js/modules/esnext.array.filter-out.js"),require("core-js/modules/esnext.array.find-last.js"),require("core-js/modules/esnext.array.find-last-index.js"),require("core-js/modules/esnext.array.is-template-object.js"),require("core-js/modules/esnext.array.last-index.js"),require("core-js/modules/esnext.array.last-item.js"),require("core-js/modules/esnext.array.unique-by.js"),require("core-js/modules/esnext.async-iterator.constructor.js"),require("core-js/modules/esnext.async-iterator.as-indexed-pairs.js"),require("core-js/modules/esnext.async-iterator.drop.js"),require("core-js/modules/esnext.async-iterator.every.js"),require("core-js/modules/esnext.async-iterator.filter.js"),require("core-js/modules/esnext.async-iterator.find.js"),require("core-js/modules/esnext.async-iterator.flat-map.js"),require("core-js/modules/esnext.async-iterator.for-each.js"),require("core-js/modules/esnext.async-iterator.from.js"),require("core-js/modules/esnext.async-iterator.map.js"),require("core-js/modules/esnext.async-iterator.reduce.js"),require("core-js/modules/esnext.async-iterator.some.js"),require("core-js/modules/esnext.async-iterator.take.js"),require("core-js/modules/esnext.async-iterator.to-array.js"),require("core-js/modules/esnext.bigint.range.js"),require("core-js/modules/esnext.composite-key.js"),require("core-js/modules/esnext.composite-symbol.js"),require("core-js/modules/esnext.global-this.js"),require("core-js/modules/esnext.iterator.constructor.js"),require("core-js/modules/esnext.iterator.as-indexed-pairs.js"),require("core-js/modules/esnext.iterator.drop.js"),require("core-js/modules/esnext.iterator.every.js"),require("core-js/modules/esnext.iterator.filter.js"),require("core-js/modules/esnext.iterator.find.js"),require("core-js/modules/esnext.iterator.flat-map.js"),require("core-js/modules/esnext.iterator.for-each.js"),require("core-js/modules/esnext.iterator.from.js"),require("core-js/modules/esnext.iterator.map.js"),require("core-js/modules/esnext.iterator.reduce.js"),require("core-js/modules/esnext.iterator.some.js"),require("core-js/modules/esnext.iterator.take.js"),require("core-js/modules/esnext.iterator.to-array.js"),require("core-js/modules/esnext.map.delete-all.js"),require("core-js/modules/esnext.map.emplace.js"),require("core-js/modules/esnext.map.every.js"),require("core-js/modules/esnext.map.filter.js"),require("core-js/modules/esnext.map.find.js"),require("core-js/modules/esnext.map.find-key.js"),require("core-js/modules/esnext.map.from.js"),require("core-js/modules/esnext.map.group-by.js"),require("core-js/modules/esnext.map.includes.js"),require("core-js/modules/esnext.map.key-by.js"),require("core-js/modules/esnext.map.key-of.js"),require("core-js/modules/esnext.map.map-keys.js"),require("core-js/modules/esnext.map.map-values.js"),require("core-js/modules/esnext.map.merge.js"),require("core-js/modules/esnext.map.of.js"),require("core-js/modules/esnext.map.reduce.js"),require("core-js/modules/esnext.map.some.js"),require("core-js/modules/esnext.map.update.js"),require("core-js/modules/esnext.map.update-or-insert.js"),require("core-js/modules/esnext.map.upsert.js"),require("core-js/modules/esnext.math.clamp.js"),require("core-js/modules/esnext.math.deg-per-rad.js"),require("core-js/modules/esnext.math.degrees.js"),require("core-js/modules/esnext.math.fscale.js"),require("core-js/modules/esnext.math.iaddh.js"),require("core-js/modules/esnext.math.imulh.js"),require("core-js/modules/esnext.math.isubh.js"),require("core-js/modules/esnext.math.rad-per-deg.js"),require("core-js/modules/esnext.math.radians.js"),require("core-js/modules/esnext.math.scale.js"),require("core-js/modules/esnext.math.seeded-prng.js"),require("core-js/modules/esnext.math.signbit.js"),require("core-js/modules/esnext.math.umulh.js"),require("core-js/modules/esnext.number.from-string.js"),require("core-js/modules/esnext.number.range.js"),require("core-js/modules/esnext.object.has-own.js"),require("core-js/modules/esnext.object.iterate-entries.js"),require("core-js/modules/esnext.object.iterate-keys.js"),require("core-js/modules/esnext.object.iterate-values.js"),require("core-js/modules/esnext.observable.js"),require("core-js/modules/esnext.promise.all-settled.js"),require("core-js/modules/esnext.promise.any.js"),require("core-js/modules/esnext.promise.try.js"),require("core-js/modules/esnext.reflect.define-metadata.js"),require("core-js/modules/esnext.reflect.delete-metadata.js"),require("core-js/modules/esnext.reflect.get-metadata.js"),require("core-js/modules/esnext.reflect.get-metadata-keys.js"),require("core-js/modules/esnext.reflect.get-own-metadata.js"),require("core-js/modules/esnext.reflect.get-own-metadata-keys.js"),require("core-js/modules/esnext.reflect.has-metadata.js"),require("core-js/modules/esnext.reflect.has-own-metadata.js"),require("core-js/modules/esnext.reflect.metadata.js"),require("core-js/modules/esnext.set.add-all.js"),require("core-js/modules/esnext.set.delete-all.js"),require("core-js/modules/esnext.set.difference.js"),require("core-js/modules/esnext.set.every.js"),require("core-js/modules/esnext.set.filter.js"),require("core-js/modules/esnext.set.find.js"),require("core-js/modules/esnext.set.from.js"),require("core-js/modules/esnext.set.intersection.js"),require("core-js/modules/esnext.set.is-disjoint-from.js"),require("core-js/modules/esnext.set.is-subset-of.js"),require("core-js/modules/esnext.set.is-superset-of.js"),require("core-js/modules/esnext.set.join.js"),require("core-js/modules/esnext.set.map.js"),require("core-js/modules/esnext.set.of.js"),require("core-js/modules/esnext.set.reduce.js"),require("core-js/modules/esnext.set.some.js"),require("core-js/modules/esnext.set.symmetric-difference.js"),require("core-js/modules/esnext.set.union.js"),require("core-js/modules/esnext.string.at.js"),require("core-js/modules/esnext.string.code-points.js"),require("core-js/modules/esnext.string.match-all.js"),require("core-js/modules/esnext.string.replace-all.js"),require("core-js/modules/esnext.symbol.async-dispose.js"),require("core-js/modules/esnext.symbol.dispose.js"),require("core-js/modules/esnext.symbol.matcher.js"),require("core-js/modules/esnext.symbol.metadata.js"),require("core-js/modules/esnext.symbol.observable.js"),require("core-js/modules/esnext.symbol.pattern-match.js"),require("core-js/modules/esnext.symbol.replace-all.js"),require("core-js/modules/esnext.typed-array.at.js"),require("core-js/modules/esnext.typed-array.filter-out.js"),require("core-js/modules/esnext.typed-array.find-last.js"),require("core-js/modules/esnext.typed-array.find-last-index.js"),require("core-js/modules/esnext.typed-array.unique-by.js"),require("core-js/modules/esnext.weak-map.delete-all.js"),require("core-js/modules/esnext.weak-map.from.js"),require("core-js/modules/esnext.weak-map.of.js"),require("core-js/modules/esnext.weak-map.emplace.js"),require("core-js/modules/esnext.weak-map.upsert.js"),require("core-js/modules/esnext.weak-set.add-all.js"),require("core-js/modules/esnext.weak-set.delete-all.js"),require("core-js/modules/esnext.weak-set.from.js"),require("core-js/modules/esnext.weak-set.of.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/web.dom-collections.iterator.js"),require("core-js/modules/web.immediate.js"),require("core-js/modules/web.queue-microtask.js"),require("core-js/modules/web.timers.js"),require("core-js/modules/web.url.js"),require("core-js/modules/web.url.to-json.js"),require("core-js/modules/web.url-search-params.js"),require("regenerator-runtime/runtime");var e=require("atom"),t=require("child_process"),r=require("atom-package-deps"),s=require("fs"),i=require("path"),o=require("atom-space-pen-views"),n=require("xterm"),a=require("cross-spawn"),u=require("events"),c=require("xregexp"),l=require("tree-kill"),d=require("cosmiconfig"),m=require("cson-parser"),h=require("@iarna/toml"),f=require("json5"),j=require("os");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function g(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var y=g(r),v=p(s),b=p(i),q=p(n),w=p(a),x=p(u),k=p(c),T=p(l),E=p(m),M=p(h),C=p(f),B=p(j);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t,r,s,i,o,n){try{var a=e[o](n),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(s,i)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(s,i){var o=e.apply(t,r);function n(e){A(o,s,i,n,a,"next",e)}function a(e){A(o,s,i,n,a,"throw",e)}n(void 0)}))}}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function L(e,t,r){return t&&z(e.prototype,t),r&&z(e,r),e}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function W(e,t,r){return(W=D()?Reflect.construct:function(e,t,r){var s=[null];s.push.apply(s,t);var i=new(Function.bind.apply(e,s));return r&&N(i,r.prototype),i}).apply(null,arguments)}function H(e){var t="function"==typeof Map?new Map:void 0;return(H=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return W(e,arguments,F(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),N(s,e)})(e)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?G(e):t}function $(e){var t=D();return function(){var r,s=F(e);if(t){var i=F(this).constructor;r=Reflect.construct(s,arguments,i)}else r=s.apply(this,arguments);return U(this,r)}}function K(e,t,r){return(K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var s=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F(e)););return e}(e,t);if(s){var i=Object.getOwnPropertyDescriptor(s,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Y(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var Q="buildium",X=Q;function Z(){var e=atom.workspace.getActiveTextEditor();return e&&e.getPath()?atom.project.getPaths().sort((function(e,t){return t.length-e.length})).find(function(){var t=V(regeneratorRuntime.mark((function t(r){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.default.promises.realpath(r);case 3:return s=t.sent,t.next=6,v.default.promises.realpath(e.getPath()).substr(0,s.length);case 6:return t.t0=t.sent,t.t1=s,t.abrupt("return",t.t0===t.t1);case 11:return t.prev=11,t.t2=t.catch(0),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()):0!==atom.project.getPaths().length&&atom.project.getPaths()[0]}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if("string"!=typeof e)return e;var r=Object.assign({},process.env,t);e=e.replace(/\$(\w+)/g,(function(e,t){return t in r?r[t]:e}));var s=atom.workspace.getActiveTextEditor(),i=atom.project.getPaths().map(function(){var e=V(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.default.promises.realpath(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()),o=i[0];if(s&&void 0!==s.getPath()){var n=v.default.realpathSync(s.getPath()),a=b.default.dirname(n);o=i.find((function(e){return a&&a.startsWith(e)})),e=(e=(e=(e=(e=e.replace(/{FILE_ACTIVE}/g,n)).replace(/{FILE_ACTIVE_PATH}/g,a)).replace(/{FILE_ACTIVE_NAME}/g,b.default.basename(n))).replace(/{FILE_ACTIVE_NAME_BASE}/g,b.default.basename(n,b.default.extname(n)))).replace(/{SELECTION}/g,s.getSelectedText());var u=s.getCursorScreenPosition();e=(e=e.replace(/{FILE_ACTIVE_CURSOR_ROW}/g,u.row+1)).replace(/{FILE_ACTIVE_CURSOR_COLUMN}/g,u.column+1)}return e=e.replace(/{PROJECT_PATH}/g,o),atom.project.getRepositories[0]&&(e=e.replace(/{REPO_BRANCH_SHORT}/g,atom.project.getRepositories()[0].getShortHead())),e}function te(){return"".concat(Q.charAt(0).toUpperCase()).concat(Q.slice(1))}var re=function(e){_(r,H(Error));var t=$(r);function r(e,s){var i;return R(this,r),(i=t.call(this,s)).name=e,i.message=s,Error.captureStackTrace(G(i),r),i}return r}(),se={schema:{panelVisibility:{title:"Panel Visibility",description:"Set when the build panel should be visible.",type:"string",default:"Toggle",enum:["Toggle","Keep Visible","Show on Error","Hidden"],order:1},autoToggleInterval:{title:"Auto-toggle Interval",description:"Set the interval until the panel closes automatically, in milliseconds. This setting works with *Panel Visibility* set to *Toggle*",type:"integer",minimum:1e3,default:3e3,order:2},buildOnSave:{title:"Automatically build on save",description:"Automatically build your project each time an editor is saved.",type:"boolean",default:!1,order:3},saveOnBuild:{title:"Automatically save on build",description:"Automatically save all edited files when triggering a build.",type:"boolean",default:!1,order:4},matchedErrorFailsBuild:{title:"Any matched error will fail the build",description:'Even if the build has a return code of zero it is marked as "failed" if any error is being matched in the output.',type:"boolean",default:!0,order:5},scrollOnError:{title:"Automatically scroll on build error",description:"Automatically scroll to first matched error when a build failed.",type:"boolean",default:!1,order:6},stealFocus:{title:"Steal Focus",description:"Steal focus when opening build panel.",type:"boolean",default:!0,order:7},selectTriggers:{title:"Selecting new target triggers the build",description:"When selecting a new target (through status-bar, cmd-alt-t, etc), the newly selected target will be triggered.",type:"boolean",default:!0,order:9},refreshOnShowTargetList:{title:"Refresh targets when the target list is shown",description:"When opening the targets menu, the targets will be refreshed.",type:"boolean",default:!1,order:10},notificationOnRefresh:{title:"Show notification when targets are refreshed",description:"When targets are refreshed a notification with information about the number of targets will be displayed.",type:"boolean",default:!1,order:11},beepWhenDone:{title:"Beep when the build completes",description:'Make a "beep" notification sound when the build is complete - in success or failure.',type:"boolean",default:!1,order:12},panelOrientation:{title:"Panel Orientation",description:"Where to attach the build panel",type:"string",default:"Bottom",enum:["Bottom","Top","Left","Right"],order:13},statusBar:{title:"Status Bar",description:"Where to place the status bar. Set to `Disable` to disable status bar display.",type:"string",default:"Left",enum:["Left","Right","Disable"],order:14},statusBarPriority:{title:"Priority on Status Bar",description:"Lower priority tiles are placed further to the left/right, depends on where you choose to place Status Bar.",type:"integer",default:-1e3,order:15},terminalScrollback:{title:"Terminal Scrollback Size",description:"Max number of lines of build log kept in the terminal",type:"integer",default:1e3,order:16},muteConflictWarning:{title:"Mute Conflict Warning",description:"Disables the startup dialog, whether the user wants to disable the original `build` package",type:"boolean",default:!1,order:17}},get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return null!=e&&e.length?atom.config.get("".concat(Q,".").concat(e)):atom.config.get("".concat(Q))},set:function(e,t){atom.config.set("".concat(Q,".").concat(e),t)},migrate:function(e,t){if(atom.config.get("".concat(Q,".").concat(e))&&!atom.config.get("".concat(Q,".").concat(t))){try{atom.config.set("".concat(Q,".").concat(t),atom.config.get("".concat(Q,".").concat(e)))}catch(e){return void atom.notifications.addWarning("Failed to migrate configuration, see console for details")}atom.config.unset("".concat(Q,".").concat(e))}},observe:function(){for(var e,t,r,s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];switch(i.length){case 2:e=i[0],r=i[1],t={};break;case 3:keyPath=i[0],t=i[1],r=i[2];break;default:return void console.error("An unsupported form of Config::observe is being used. See https://atom.io/docs/api/latest/Config for details")}atom.config.observe("".concat(Q,".").concat(e),t,r)},unset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null!=e&&e.length?"".concat(Q,".").concat(e):Q;atom.config.unset(t)},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=P({pending:!0,searchAllPanes:!0},e),atom.workspace.open("atom://config/packages/".concat(Q),e)}},ie=function(e){_(r,o.View);var t=$(r);function r(){var e;R(this,r);for(var s=arguments.length,i=new Array(s),n=0;n<s;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))).starttime=new Date,e.terminal=new q.default({cursorBlink:!1,convertEol:!0,useFocus:!1,termName:"xterm-256color",scrollback:se.get("terminalScrollback")}),e.terminal.prependListener=function(){var t;(t=e.terminal).on.apply(t,arguments)},e.terminal.prependOnceListener=function(){var t;(t=e.terminal).addOnceListener.apply(t,arguments)},e.terminal.getContent=function(){return this.lines.reduce((function(e,t){return e+t.reduce((function(e,t){return e+t[1]}),"")+"\n"}),"")},e.fontGeometry={w:15,h:15},e.terminal.open(e.output[0]),e.destroyTerminal=e.terminal.destroy.bind(G(e)),e.terminal.destroy=e.terminal.destroySoon=function(){},e.terminalEl=o.$(e.terminal.element),e.terminalEl[0].terminal=e.terminal,e.resizeStarted=e.resizeStarted.bind(G(e)),e.resizeMoved=e.resizeMoved.bind(G(e)),e.resizeEnded=e.resizeEnded.bind(G(e)),se.observe("panelVisibility",e.visibleFromConfig.bind(G(e))),se.observe("panelOrientation",e.orientationFromConfig.bind(G(e))),atom.config.observe("editor.fontSize",e.fontSizeFromConfig.bind(G(e))),atom.config.observe("editor.fontFamily",e.fontFamilyFromConfig.bind(G(e))),atom.commands.add("atom-workspace","buildium:toggle-panel",e.toggle.bind(G(e))),e}return L(r,[{key:"destroy",value:function(){this.destroyTerminal(),clearInterval(this.detectResizeInterval)}},{key:"resizeStarted",value:function(){document.body.style["-webkit-user-select"]="none",document.addEventListener("mousemove",this.resizeMoved),document.addEventListener("mouseup",this.resizeEnded)}},{key:"resizeMoved",value:function(e){var t=this.fontGeometry.h;switch(se.get("panelOrientation")){case"Bottom":var r=this.resizer.get(0).getBoundingClientRect().top-e.y;if(Math.abs(r)<5*t/6)return;var s=Math.round((this.terminalEl.height()+r)/t)*t,i=o.$(".item-views").height()+o.$(".build .output").height();this.terminalEl.css("height","".concat(Math.min(i,s),"px"));break;case"Top":var n=this.resizer.get(0).getBoundingClientRect().top-e.y;if(Math.abs(n)<5*t/6)return;var a=Math.round((this.terminalEl.height()-n)/t)*t,u=o.$(".item-views").height()+o.$(".build .output").height();this.terminalEl.css("height","".concat(Math.min(u,a),"px"));break;case"Left":var c=this.resizer.get(0).getBoundingClientRect().right-e.x;this.css("width","".concat(this.width()-c-this.resizer.outerWidth(),"px"));break;case"Right":var l=this.resizer.get(0).getBoundingClientRect().left-e.x;this.css("width","".concat(this.width()+l,"px"))}this.resizeTerminal()}},{key:"resizeEnded",value:function(){document.body.style["-webkit-user-select"]="text",document.removeEventListener("mousemove",this.resizeMoved),document.removeEventListener("mouseup",this.resizeEnded)}},{key:"resizeToNearestRow",value:function(){-1!==["Top","Bottom"].indexOf(se.get("panelOrientation"))&&this.fixTerminalElHeight(),this.resizeTerminal()}},{key:"getFontGeometry",value:function(){var e=o.$("<div>A</div>").addClass("terminal").addClass("terminal-test").appendTo(this.output),t=e[0].getBoundingClientRect().width,r=e[0].getBoundingClientRect().height;return e.remove(),{w:t,h:r}}},{key:"resizeTerminal",value:function(){this.fontGeometry=this.getFontGeometry();var e=this.fontGeometry,t=e.w,r=e.h;if(0!==t&&0!==r){var s=Math.floor(this.terminalEl.width()/t),i=Math.floor(this.terminalEl.height()/r);this.terminal.resize(s,i)}}},{key:"getContent",value:function(){return this.terminal.getContent()}},{key:"attach",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)switch(se.get("panelVisibility")){case"Hidden":case"Show on Error":return}this.panel&&this.panel.destroy();var t={Top:atom.workspace.addTopPanel,Bottom:atom.workspace.addBottomPanel,Left:atom.workspace.addLeftPanel,Right:atom.workspace.addRightPanel},r=se.get("panelOrientation")||"Bottom";this.panel=t[r].call(atom.workspace,{item:this}),this.fixTerminalElHeight(),this.resizeToNearestRow()}},{key:"fixTerminalElHeight",value:function(){var e=o.$(".build .output").height();this.terminalEl.css("height","".concat(e,"px"))}},{key:"detach",value:function(e){e=e||!1,atom.views.getView(atom.workspace)&&document.activeElement===this[0]&&atom.views.getView(atom.workspace).focus(),this.panel&&(e||"Keep Visible"!==se.get("panelVisibility"))&&(this.panel.destroy(),this.panel=null)}},{key:"isAttached",value:function(){return!!this.panel}},{key:"visibleFromConfig",value:function(e){switch(e){case"Toggle":case"Show on Error":return void(this.terminalEl.hasClass("error")||this.detach())}this.attach()}},{key:"orientationFromConfig",value:function(e){var t=this.isVisible();switch(this.detach(!0),t&&this.attach(),this.resizer.get(0).removeEventListener("mousedown",this.resizeStarted),e){case"Top":case"Bottom":this.get(0).style.width=null,this.resizer.get(0).addEventListener("mousedown",this.resizeStarted);break;case"Left":case"Right":this.terminalEl.get(0).style.height=null,this.resizer.get(0).addEventListener("mousedown",this.resizeStarted)}this.resizeTerminal()}},{key:"fontSizeFromConfig",value:function(e){this.css({"font-size":e}),this.resizeToNearestRow()}},{key:"fontFamilyFromConfig",value:function(e){this.css({"font-family":e}),this.resizeToNearestRow()}},{key:"reset",value:function(){clearTimeout(this.titleTimer),this.buildTimer.text(r.initialTimerText()),this.titleTimer=0,this.terminal.reset(),this.panelHeading.removeClass("success error"),this.title.removeClass("success error"),this.detach()}},{key:"updateTitle",value:function(){this.buildTimer.text(((new Date-this.starttime)/1e3).toFixed(3)+" s"),this.titleTimer=setTimeout(this.updateTitle.bind(this),100)}},{key:"close",value:function(){this.detach(!0)}},{key:"toggle",value:function(){this.isAttached()?this.detach(!0):this.attach(!0)}},{key:"clearOutput",value:function(){this.terminal.reset()}},{key:"build",value:function(){atom.commands.dispatch(atom.views.getView(atom.workspace),"buildium:trigger")}},{key:"setHeading",value:function(e){this.heading.text(e)}},{key:"buildStarted",value:function(){this.starttime=new Date,this.reset(),this.attach(),se.get("stealFocus")&&this.focus(),this.updateTitle()}},{key:"buildFinished",value:function(e){e||this.isAttached()||this.attach("Show on Error"===se.get("panelVisibility")),this.finalizeBuild(e)}},{key:"buildAbortInitiated",value:function(){this.heading.addClass("icon-stop")}},{key:"buildAborted",value:function(){this.finalizeBuild(!1)}},{key:"finalizeBuild",value:function(e){this.title.addClass(e?"success":"error"),this.panelHeading.addClass(e?"success":"error"),this.heading.removeClass("icon-stop"),clearTimeout(this.titleTimer)}},{key:"scrollTo",value:function(e){for(var t=this.getContent(),r=-1,s=e.length;-1===r&&s>0;)r=t.indexOf(e.substring(0,s--));if(0!==s){var i=t.slice(0,r).split("\n").length;this.terminal.ydisp=0,this.terminal.scrollDisp(i-1)}}}],[{key:"initialTimerText",value:function(){return"0.000 s"}},{key:"initialHeadingText",value:function(){return"".concat(te()," ").concat("v".concat("0.75.3"))}},{key:"content",value:function(){var e=this;this.div({tabIndex:-1,class:"build tool-panel native-key-bindings"},(function(){e.div({class:"heading",outlet:"panelHeading"},(function(){e.div({class:"control-container"},(function(){e.button({class:"btn btn-default icon icon-zap",click:"build",title:"Builds current project"},"Build"),e.button({class:"btn btn-default icon icon-trashcan",click:"clearOutput",title:"Clears the output"},"Clear"),e.button({class:"btn btn-default icon icon-x",click:"close",title:"Closes the build panel"},"Close"),e.div({class:"title",outlet:"title"},(function(){e.span({class:"build-timer",outlet:"buildTimer"},e.initialTimerText())}))})),e.div({class:"icon heading-text text-highlight",outlet:"heading"},e.initialHeadingText())})),e.div({class:"output panel-body",outlet:"output"}),e.div({class:"resizer",outlet:"resizer"})}))}}]),r}(),oe="\n  background-color: darkslateblue;\n  border-radius: 2px;\n  color: white;\n  line-height: 1.5;\n  padding: 1px 4px;\n  text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);\n";function ne(e){var t,r;if(null!==(t=atom)&&void 0!==t&&t.inDevMode()){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];i.unshift("%c".concat(Q,"%c"),oe,""),(r=window.console)[e].apply(r,i)}}var ae=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ne.apply(void 0,["log"].concat(t))},ue=function(e){_(r,u.EventEmitter);var t=$(r);function r(){var e;return R(this,r),(e=t.call(this)).regex=null,e.cwd=null,e.stdout=null,e.stderr=null,e.currentMatch=[],e.firstMatchId=null,atom.commands.add("atom-workspace","buildium:error-match",e.match.bind(G(e))),atom.commands.add("atom-workspace","buildium:error-match-first",e.matchFirst.bind(G(e))),e}return L(r,[{key:"_gotoNext",value:function(){0!==this.currentMatch.length&&this.goto(this.currentMatch[0].id)}},{key:"goto",value:function(e){var t=this,r=this.currentMatch.find((function(t){return t.id===e}));if(r){for(;this.currentMatch[0]!==r;)this.currentMatch.push(this.currentMatch.shift());this.currentMatch.push(this.currentMatch.shift());var s=r.file;if(s){b.default.isAbsolute(s)||(s=this.cwd+b.default.sep+s);var i=r.line?r.line-1:0,o=r.col?r.col-1:0;v.default.exists(s,(function(e){e?(atom.workspace.open(s,{initialLine:i,initialColumn:o,searchAllPanes:!0}),t.emit("matched",r)):t.emit("error","Matched file does not exist: "+s)}))}else this.emit("error","Did not match any file. Don't know what to open.")}else this.emit("error","Can't find match with id "+e)}},{key:"_parse",value:function(){var e=this;this.currentMatch=[],this.functions&&this.functions.forEach((function(t,r){e.currentMatch=e.currentMatch.concat(t(e.output).map((function(e,t){return e.id="error-match-function-"+r+"-"+t,e.type=e.type||"Error",e})))})),Object.keys(this.regex).forEach((function(t){e.regex[t]&&e.regex[t].forEach((function(r,s){r&&k.default.forEach(e.output,r,(function(r,i){r.id="error-match-"+s+"-"+i,r.type=t,e.currentMatch.push(r)}))}))})),this.currentMatch.sort((function(e,t){return e.index-t.index})),this.firstMatchId=this.currentMatch.length>0?this.currentMatch[0].id:null}},{key:"_prepareRegex",value:function(e){var t=this;return(e=(e=e||[])instanceof Array?e:[e]).map((function(e){try{return k.default(e)}catch(e){return t.emit("error","Error parsing regex. "+e.message),null}}))}},{key:"set",value:function(e,t,r){var s=this;e.functionMatch&&(this.functions=(e.functionMatch instanceof Array?e.functionMatch:[e.functionMatch]).filter((function(e){return"function"==typeof e||(s.emit("error","found functionMatch that is no function: "+O(e)),!1)}))),this.regex={Error:this._prepareRegex(e.errorMatch),Warning:this._prepareRegex(e.warningMatch)},this.cwd=t,this.output=r,this.currentMatch=[],this._parse()}},{key:"match",value:function(){this._gotoNext()}},{key:"matchFirst",value:function(){this.firstMatchId&&this.goto(this.firstMatchId)}},{key:"hasMatch",value:function(){return 0!==this.currentMatch.length}},{key:"getMatches",value:function(){return this.currentMatch}}]),r}(),ce=function(){function e(t){R(this,e),this.linter=t.register({name:"Build"})}return L(e,[{key:"destroy",value:function(){this.linter.dispose()}},{key:"clear",value:function(){this.linter.deleteMessages()}},{key:"processMessages",value:function(e,t){function r(e){return[[(e.line||1)-1,(e.col||1)-1],[(e.line_end||e.line||1)-1,(e.col_end||e.col||1)-1]]}function s(e){return b.default.isAbsolute(e)?e:b.default.join(t,e)}function i(e){switch(e&&e.toLowerCase()){case"err":case"error":return"error";case"warn":case"warning":return"warning";default:return null}}this.linter.setMessages(e.map((function(e){return{type:e.type||"Error",text:e.message||e.html_message?e.message:"Error from build",html:e.message?void 0:e.html_message,filePath:s(e.file),severity:i(e.type),range:r(e),trace:e.trace&&e.trace.map((function(e){return{type:e.type||"Trace",text:e.message||e.html_message?e.message:"Trace in build",html:e.message?void 0:e.html_message,filePath:e.file&&s(e.file),severity:i(e.type)||"info",range:r(e)}}))}})))}}]),e}(),le=function(e){_(r,o.View);var t=$(r);function r(){return R(this,r),t.apply(this,arguments)}return L(r,[{key:"destroy",value:function(){this.confirmcb=void 0,this.cancelcb=void 0,this.panel&&(this.panel.destroy(),this.panel=null)}},{key:"show",value:function(e,t){this.confirmcb=e,this.cancelcb=t,this.panel=atom.workspace.addTopPanel({item:this}),this.saveBuildButton.focus()}},{key:"cancel",value:function(){this.destroy(),this.cancelcb&&this.cancelcb()}},{key:"saveAndConfirm",value:function(){this.confirmcb&&this.confirmcb(!0),this.destroy()}},{key:"confirmWithoutSave",value:function(){this.confirmcb&&this.confirmcb(!1),this.destroy()}}],[{key:"content",value:function(){var e=this;this.div({class:"build-confirm overlay from-top"},(function(){e.h3("You have unsaved changes"),e.div({class:"btn-container pull-right"},(function(){e.button({class:"btn btn-success",outlet:"saveBuildButton",title:"Save and Build",click:"saveAndConfirm"},"Save and build"),e.button({class:"btn btn-info",title:"Build Without Saving",click:"confirmWithoutSave"},"Build Without Saving")})),e.div({class:"btn-container pull-left"},(function(){e.button({class:"btn btn-info",title:"Cancel",click:"cancel"},"Cancel")}))}))}}]),r}(),de=function(e){_(r,o.View);var t=$(r);function r(e){var s;R(this,r);for(var i=arguments.length,o=new Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return(s=t.call.apply(t,[this].concat(o))).statusBar=e,se.observe("statusBar",(function(){return s.attach()})),se.observe("statusBarPriority",(function(){return s.attach()})),s}return L(r,[{key:"attach",value:function(){var e=this;this.destroy();var t=se.get("statusBar");"Disable"!==t&&(this.statusBarTile=this.statusBar["add".concat(t,"Tile")]({item:this,priority:se.get("statusBarPriority")}),this.tooltip=atom.tooltips.add(this,{title:function(){return e.tooltipMessage()}}))}},{key:"destroy",value:function(){this.statusBarTile&&(this.statusBarTile.destroy(),this.statusBarTile=null),this.tooltip&&(this.tooltip.dispose(),this.tooltip=null)}},{key:"tooltipMessage",value:function(){return"Current build target is '".concat(this.element.textContent,"'")}},{key:"setClasses",value:function(e){this.removeClass("status-unknown status-success status-error"),this.addClass(e)}},{key:"setTarget",value:function(e){this.target!==e&&(this.target=e,this.message.text(e||""),this.setClasses())}},{key:"buildAborted",value:function(){this.setBuildSuccess(!1)}},{key:"setBuildSuccess",value:function(e){this.setClasses(e?"status-success":"status-error")}},{key:"buildStarted",value:function(){this.setClasses()}},{key:"onClick",value:function(e){this.onClick=e}},{key:"clicked",value:function(){this.onClick&&this.onClick()}}],[{key:"content",value:function(){var e=this;this.div({id:"build-status-bar",class:"inline-block"},(function(){e.a({click:"clicked",outlet:"message"})}))}}]),r}(),me=function(e){_(r,o.SelectListView);var t=$(r);function r(){var e;return R(this,r),(e=t.apply(this,arguments)).show(),e}return L(r,[{key:"initialize",value:function(){K(F(r.prototype),"initialize",this).apply(this,arguments),this.addClass("build-target"),this.list.addClass("mark-active")}},{key:"show",value:function(){this.panel=atom.workspace.addModalPanel({item:this}),this.panel.show(),this.focusFilterEditor()}},{key:"hide",value:function(){this.panel.hide()}},{key:"setItems",value:function(){K(F(r.prototype),"setItems",this).apply(this,arguments);var e=this.find(".active");0<e.length&&(this.selectItemView(e),this.scrollToItemView(e))}},{key:"setActiveTarget",value:function(e){this.activeTarget=e}},{key:"viewForItem",value:function(e){var t=this.activeTarget;return r.render((function(){var r=e===t?"active":"";this.li({class:r+" build-target"},e)}))}},{key:"getEmptyMessage",value:function(e){return 0===e?"No targets found.":"No matches"}},{key:"awaitSelection",value:function(){var e=this;return new Promise((function(t,r){e.resolveFunction=t}))}},{key:"confirmed",value:function(e){this.resolveFunction&&(this.resolveFunction(e),this.resolveFunction=null),this.hide()}},{key:"cancelled",value:function(){this.hide()}}]),r}(),he=function(t){_(s,x["default"]);var r=$(s);function s(){var e;R(this,s),e=r.call(this);var t=atom.project.getPaths();return e.pathTargets=t.map((function(t){return e._defaultPathTarget(t)})),atom.project.onDidChangePaths((function(r){var s=r.filter((function(e){return-1===t.indexOf(e)})),i=t.filter((function(e){return-1===r.indexOf(e)}));s.forEach((function(t){return e.pathTargets.push(e._defaultPathTarget(t))})),e.pathTargets=e.pathTargets.filter((function(e){return-1===i.indexOf(e.path)})),e.refreshTargets(s),t=r})),atom.commands.add("atom-workspace","buildium:refresh-targets",(function(){return e.refreshTargets()})),atom.commands.add("atom-workspace","buildium:select-active-target",(function(){return e.selectActiveTarget()})),e}return L(s,[{key:"setBusyProvider",value:function(e){this.busyProvider=e}},{key:"_defaultPathTarget",value:function(t){return{path:t,loading:!1,targets:[],instancedTools:[],activeTarget:null,tools:[],subscriptions:new e.CompositeDisposable}}},{key:"destroy",value:function(){this.pathTargets.forEach((function(e){return e.tools.map((function(e){e.removeAllListeners&&e.removeAllListeners("refresh"),e.destructor&&e.destructor()}))}))}},{key:"setTools",value:function(e){this.tools=e||[]}},{key:"refreshTargets",value:function(t){var r=this;ae("Refreshing targets"),t=t||atom.project.getPaths(),this.busyProvider&&this.busyProvider.add("Refreshing targets for ".concat(t.join(",")));var s=t.map((function(t){var s=r.pathTargets.find((function(e){return e.path===t}));s.loading=!0,s.instancedTools=s.instancedTools.map((function(e){return e.removeAllListeners&&e.removeAllListeners("refresh")})).filter((function(){return!1}));var i=r.tools.map((function(e){return new e(t)})).filter((function(e){return e.isEligible()})).map((function(e){return s.instancedTools.push(e),e.on&&e.on("refresh",r.refreshTargets.bind(r,[t])),Promise.resolve().then(V(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.settings();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).catch((function(t){if(t instanceof SyntaxError)atom.notifications.addError("Invalid build file.",{detail:"You have a syntax error in your build file: "+t.message,dismissable:!0});else{var r=e.getNiceName();atom.notifications.addError("Ooops. Something went wrong"+(r?" in the "+r+" build provider":"")+".",{detail:t.message,stack:t.stack,dismissable:!0})}}))}));return Promise.all(i).then((function(i){return i=function(e){var t=function(e,t){return"".concat(e," - ").concat(t)},r=[];return e.forEach((function(e){for(var s=0,i=e.name;r.find((function(e){return e.name===i}));)i=t(e.name,++s);r.push(P(P({},e),{},{name:i}))})),r}([].concat.apply([],i).filter(Boolean).map((function(e){return function(e,t){return Object.assign({},t,{env:t.env||{},args:t.args||[],cwd:t.cwd||e,sh:void 0===t.sh||t.sh,errorMatch:t.errorMatch||""})}(t,e)}))),null!==s.activeTarget&&i.find((function(e){return e.name===s.activeTarget}))||(s.activeTarget=i[0]?i[0].name:void 0),s.subscriptions.dispose(),s.subscriptions=new e.CompositeDisposable,i.forEach((function(e,t){if(e.keymap&&!e.atomCommandName&&(e.atomCommandName="buildium:trigger:".concat(e.name)),e.atomCommandName&&s.subscriptions.add(atom.commands.add("atom-workspace",e.atomCommandName,(function(e){return r.emit("trigger",e)}))),e.keymap){var i={"atom-workspace, atom-text-editor":{}};i["atom-workspace, atom-text-editor"][e.keymap]=e.atomCommandName,s.subscriptions.add(atom.keymaps.add(e.name,i))}})),s.targets=i,s.loading=!1,s})).catch((function(e){atom.notifications.addError("Ooops. Something went wrong.",{detail:e.message,stack:e.stack,dismissable:!0})}))}));return Promise.all(s).then((function(e){if(r.fillTargets(Z(),!1),r.emit("refresh-complete"),r.busyProvider&&r.busyProvider.remove("Refreshing targets for ".concat(t.join(","))),0!==e.length&&se.get("notificationOnRefresh")){var s=t.map((function(e){var t=r.pathTargets.find((function(t){return t.path===e}));return t?"".concat(t.targets.length," targets at: ").concat(e):"Targets ".concat(e," no longer exists. Is build deactivated?")}));atom.notifications.addInfo("Build targets parsed.",{detail:s.join("\n")})}})).catch((function(e){atom.notifications.addError("Ooops. Something went wrong.",{detail:e.message,stack:e.stack,dismissable:!0})}))}},{key:"fillTargets",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.targetsView){var s=this.getActiveTarget(e);s&&this.targetsView.setActiveTarget(s.name),this.getTargets(e,r).then((function(e){return e.map((function(e){return e.name}))})).then((function(e){return t.targetsView&&t.targetsView.setItems(e)}))}}},{key:"selectActiveTarget",value:function(){var e=this;se.get("refreshOnShowTargetList")&&this.refreshTargets();var t=Z();t?(this.targetsView=new me,this.isLoading(t)?this.targetsView.setLoading("Loading project build targets"):this.fillTargets(t),this.targetsView.awaitSelection().then((function(r){e.setActiveTarget(t,r),e.targetsView=null})).catch((function(t){e.targetsView.setError(t.message),e.targetsView=null}))):atom.notifications.addWarning("Unable to build.",{detail:"Open file is not part of any open project in Atom"})}},{key:"getTargets",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.pathTargets.find((function(t){return t.path===e}));return r?t&&0===r.targets.length?this.refreshTargets([r.path]).then((function(){return r.targets})):Promise.resolve(r.targets):Promise.resolve([])}},{key:"getActiveTarget",value:function(e){var t=this.pathTargets.find((function(t){return t.path===e}));return t?t.targets.find((function(e){return e.name===t.activeTarget})):null}},{key:"setActiveTarget",value:function(e,t){this.pathTargets.find((function(t){return t.path===e})).activeTarget=t,this.emit("new-active-target",e,this.getActiveTarget(e))}},{key:"isLoading",value:function(e){return this.pathTargets.find((function(t){return t.path===e})).loading}}]),s}(),fe={cson:function(e,t){try{return E.default.parse(t)}catch(t){throw t.message="TOML Error in ".concat(e,":\n").concat(t.message),t}},json5:function(e,t){try{return C.default.parse(t)}catch(t){throw t.message="TOML Error in ".concat(e,":\n").concat(t.message),t}},toml:function(e,t){try{return M.default.parse(t)}catch(t){throw t.message="TOML Error in ".concat(e,":\n").concat(t.message),t}}},je=d.cosmiconfig(X,{searchPlaces:[".atom-build.cjs",".atom-build.js",".atom-build.json",".atom-build.json5",".atom-build.toml",".atom-build.yaml",".atom-build.yml"],loaders:{".cson":fe.cson,".toml":fe.toml,".json":fe.json5,".json5":fe.json5,noExt:d.defaultLoaders[".json"]}});function pe(e){return ge.apply(this,arguments)}function ge(){return(ge=V(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.default.promises.realpath(t);case 2:return r=e.sent,e.next=5,je.load(r);case 5:if(e.t0=e.sent.config,e.t0){e.next=8;break}e.t0={};case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e,t){var r={name:"Custom: "+t,exec:e.cmd,env:e.env,args:e.args,cwd:e.cwd,sh:e.sh,errorMatch:e.errorMatch,functionMatch:e.functionMatch,warningMatch:e.warningMatch,atomCommandName:e.atomCommandName,keymap:e.keymap,killSignals:e.killSignals};return"function"==typeof e.postBuild&&(r.postBuild=e.postBuild),"function"==typeof e.preBuild&&(r.preBuild=e.preBuild),r}var ve=function(e){_(s,x["default"]);var t,r=$(s);function s(e){var t;return R(this,s),(t=r.call(this)).cwd=e,t.fileWatchers=[],t}return L(s,[{key:"destructor",value:function(){this.fileWatchers.map((function(e){return e.close()}))}},{key:"getNiceName",value:function(){return"Custom file"}},{key:"isEligible",value:function(){var e=this;return this.files=[].concat.apply([],["cjs","js","json","json5","cson",,"toml","yaml","yml"].map((function(t){return[b.default.join(e.cwd,".atom-build.".concat(t)),b.default.join(B.default.homedir(),".atom-build.".concat(t))]}))).filter(v.default.existsSync),0<this.files.length}},{key:"settings",value:(t=V(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fileWatchers.map((function(e){return e.close()})),this.fileWatchers=this.files.map((function(e){return("linux"===B.default.platform()?v.default.watchFile:v.default.watch)(e,(function(){return r.emit("refresh")}))})),t=[],e.next=5,Promise.all(this.files.map(function(){var e=V(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return e.sent.map((function(e){t.push.apply(t,[ye(e,e.name||"default")].concat(Y(Object.keys(e.targets||{}).map((function(t){return ye(e.targets[t],t)})))))})),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),s}(),be={config:se.schema,activate:function(){var e=this;ae("Activating package"),/^win/.test(process.platform)||(process.env.PATH=(process.env.PATH?process.env.PATH+":":"")+"/usr/local/bin"),y.install(Q),this.tools=[ve],this.linter=null,this.setupTargetManager(),this.setupBuildView(),this.setupErrorMatcher(),atom.commands.add("atom-workspace","buildium:trigger",(function(){return e.build("trigger")})),atom.commands.add("atom-workspace","buildium:stop",(function(){return e.stop()})),atom.commands.add("atom-workspace","buildium:confirm",(function(){document.activeElement.click()})),atom.commands.add("atom-workspace","buildium:no-confirm",(function(){e.saveConfirmView&&e.saveConfirmView.cancel()})),atom.workspace.observeTextEditors((function(t){t.onDidSave((function(){se.get("buildOnSave")&&e.build("save")}))})),atom.workspace.onDidChangeActivePaneItem((function(){return e.updateStatusBar()})),atom.packages.onDidActivateInitialPackages((function(){return e.targetManager.refreshTargets()})),!se.get("muteConflictWarning")&&atom.packages.isPackageActive("build")&&this.disableBuild()},setupTargetManager:function(){var e=this;this.targetManager=new he,this.targetManager.setTools(this.tools),this.targetManager.on("refresh-complete",(function(){e.updateStatusBar()})),this.targetManager.once("refresh-complete",(function(){ae("First refresh complete"),atom.packages.onDidActivatePackage((function(t){t.name.startsWith("build-")&&t.mainModule.provideBuilder&&(ae("Activating",t.name),e.targetManager.refreshTargets())})),atom.packages.onDidDeactivatePackage((function(t){t.name.startsWith("build-")&&t.mainModule.provideBuilder&&(ae("Deactivating",t.name),e.targetManager.refreshTargets())}))})),this.targetManager.on("new-active-target",(function(){e.updateStatusBar(),se.get("selectTriggers")&&e.build("trigger")})),this.targetManager.on("trigger",(function(t){return e.build("trigger",t)}))},setupBuildView:function(){this.buildView=new ie},setupErrorMatcher:function(){var e=this;this.errorMatcher=new ue,this.errorMatcher.on("error",(function(e){atom.notifications.addError("Error matching failed!",{detail:e})})),this.errorMatcher.on("matched",(function(t){t[0]&&e.buildView.scrollTo(t[0])}))},deactivate:function(){ae("Deactivating package"),this.child&&(this.child.removeAllListeners(),T.default(this.child.pid,"SIGKILL"),this.child=null),this.statusBarView&&this.statusBarView.destroy(),this.buildView&&this.buildView.destroy(),this.saveConfirmView&&this.saveConfirmView.destroy(),this.linter&&this.linter.destroy(),this.targetManager.destroy(),clearTimeout(this.finishedTimer)},updateStatusBar:function(){var e=Z(),t=this.targetManager.getActiveTarget(e);this.statusBarView&&t&&this.statusBarView.setTarget(t.name)},startNewBuild:function(e,r){var s=this,i=Z(),o="";this.linter&&this.linter.clear(),Promise.resolve(this.targetManager.getTargets(i)).then((function(e){if(!e||0===e.length)throw new re("No eligible build target.","No configuration to build this project exists.");var t=e.find((function(e){return e.atomCommandName===r}));if(t||(t=s.targetManager.getActiveTarget(i)),!t.exec)throw new re("Invalid build file.","No executable command specified.");return s.statusBarView&&s.statusBarView.buildStarted(),s.busyProvider&&s.busyProvider.add("".concat(te(),": ").concat(t.name)),s.buildView.buildStarted(),s.buildView.setHeading("Running preBuild..."),Promise.resolve(t.preBuild?t.preBuild():null).then((function(){return t}))})).then((function(e){var r=ee,i=Object.assign({},process.env,e.env);Object.keys(i).forEach((function(t){i[t]=r(i[t],e.env)}));var n=r(e.exec,e.env),a=e.args.map((function(t){return r(t,e.env)})),u=r(e.cwd,e.env),c="win32"===process.platform,l=c?"cmd":"/bin/sh",d=c?"/C":"-c";o=[e.sh?"".concat(l," ").concat(d," ").concat(n):n].concat(Y(a),["\n"]).join(" "),s.buildView.setHeading(o),e.sh?s.child=t.spawn(l,[d,[n].concat(a).join(" ")],{cwd:u,env:i,stdio:["ignore",null,null]}):s.child=w.default(n,a,{cwd:u,env:i,stdio:["ignore",null,null]});var m="",h="";s.child.stdout.setEncoding("utf8"),s.child.stderr.setEncoding("utf8"),s.child.stdout.on("data",(function(e){return m+=e})),s.child.stderr.on("data",(function(e){return h+=e})),s.child.stdout.pipe(s.buildView.terminal),s.child.stderr.pipe(s.buildView.terminal),s.child.killSignals=(e.killSignals||["SIGINT","SIGTERM","SIGKILL"]).slice(),s.child.on("error",(function(t){s.buildView.terminal.write((e.sh?"Unable to execute with shell: ":"Unable to execute: ")+n+"\n"),/\s/.test(n)&&!e.sh&&s.buildView.terminal.write("`cmd` cannot contain space. Use `args` for arguments.\n"),"ENOENT"===t.code&&(s.buildView.terminal.write("Make sure cmd:'".concat(n,"' and cwd:'").concat(u,"' exists and have correct access permissions.\n")),s.buildView.terminal.write("Binaries are found in these folders: ".concat(process.env.PATH,"\n")))})),s.child.on("close",(function(t){s.child=null,s.errorMatcher.set(e,u,m+h);var r=0===t;return se.get("matchedErrorFailsBuild")&&(r=r&&!s.errorMatcher.getMatches().some((function(e){return e.type&&"error"===e.type.toLowerCase()}))),s.linter&&s.linter.processMessages(s.errorMatcher.getMatches(),u),se.get("beepWhenDone")&&atom.beep(),s.buildView.setHeading("Running postBuild..."),Promise.resolve(e.postBuild?e.postBuild(r,m,h):null).then((function(){s.buildView.setHeading(o),s.busyProvider&&s.busyProvider.remove("".concat(te(),": ").concat(e.name),r),s.buildView.buildFinished(r),s.statusBarView&&s.statusBarView.setBuildSuccess(r),r?s.finishedTimer=setTimeout((function(){s.buildView.detach()}),se.get("autoToggleInterval")):se.get("scrollOnError")&&s.errorMatcher.matchFirst(),s.nextBuild&&s.nextBuild(),s.nextBuild=null}))}))})).catch((function(t){if(t instanceof re){if("save"===e)return;atom.notifications.addWarning(t.name,{detail:t.message,stack:t.stack})}else atom.notifications.addError("Failed to build.",{detail:t.message,stack:t.stack})}))},sendNextSignal:function(){try{var e=this.child.killSignals.shift();T.default(this.child.pid,e)}catch(e){}},abort:function(e){var t=this;this.child.killed||(this.buildView.buildAbortInitiated(),this.child.killed=!0,this.child.on("exit",(function(){t.child=null,e&&e()}))),this.sendNextSignal()},build:function(e,t){var r=this;clearTimeout(this.finishedTimer),this.doSaveConfirm(this.unsavedTextEditors(),(function(){var s=r.startNewBuild.bind(r,e,t?t.type:null);return r.child?(r.nextBuild=s,r.abort()):s()}))},doSaveConfirm:function(e,t,r){var s=function(r){e.map((function(e){return r&&e.save()})),t()};0===e.length||se.get("saveOnBuild")?s(!0):(this.saveConfirmView&&this.saveConfirmView.destroy(),this.saveConfirmView=new le,this.saveConfirmView.show(s,r))},unsavedTextEditors:function(){return atom.workspace.getTextEditors().filter((function(e){return e.isModified()&&void 0!==e.getPath()}))},stop:function(){var e=this;this.nextBuild=null,clearTimeout(this.finishedTimer),this.child?this.abort((function(){e.buildView.buildAborted(),e.statusBarView&&e.statusBarView.buildAborted()})):this.buildView.reset()},disableBuild:function(){var e=atom.notifications.addWarning("In order to avoid conflicts, it's recommended to disable (or remove) the original `build` package",{dismissable:!0,buttons:[{text:"Disable Package",className:"icon icon-playback-pause",onDidClick:function(){return atom.packages.disablePackage("build"),e.dismiss()}},{text:"Don't Ask Again",onDidClick:function(){return se.set("muteConflictWarning",!0),e.dismiss()}}]})},consumeLinterRegistry:function(e){ae("Consuming linter"),this.linter&&this.linter.destroy(),this.linter=new ce(e)},consumeBuilder:function(t){var r,s=this;return ae("Consuming builder"),Array.isArray(t)?(r=this.tools).push.apply(r,Y(t)):this.tools.push(t),this.targetManager.setTools(this.tools),new e.Disposable((function(){s.tools=s.tools.filter(Array.isArray(t)?function(e){return-1===t.indexOf(e)}:function(e){return e!==t}),s.targetManager.setTools(s.tools)}))},consumeStatusBar:function(e){var t=this;ae("Consuming status-bar"),this.statusBarView=new de(e),this.statusBarView.onClick((function(){return t.targetManager.selectActiveTarget()})),this.statusBarView.attach(),this.targetManager.refreshTargets()},consumeBusySignal:function(e){ae("Consuming busy-signal"),this.busyProvider=e.create(),this.targetManager.setBusyProvider(this.busyProvider)}};module.exports=be;
